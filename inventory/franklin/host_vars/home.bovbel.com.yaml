---
ansible_user: pbovbel
ansible_become_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  65383961633262653965396137356130343761346562336336326432323666383465393765663662
  3536653038643831643736343734646337626430653464650a626661343665613364653938393661
  36633737666564303639396431323338616132616235396135356434643964393761656236643666
  3430316536656539660a383266653164383531393838653433313566613133363533306463366134
  3933
ansible_email: paul@bovbel.com

admin_users:
  - paul@bovbel.com

web_user: pbovbel
web_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  37636239323865633539653364323932306132363933343365346532363566366464363963383863
  3939356464393138363532336565626261643262656466630a383938626531623138323136613461
  30646464393363613932393933303262626264313063356464656232353864643430323734373630
  3061656461643865640a643762626633646130666264373137386161653663303331646332343164
  3931

# Route53 DDNS configuration
aws_ddns_hosted_zone: ZJMZZCLW5S6T9
aws_access_key_id: AKIA2MCQ5AI3ATQ5HA75
aws_secret_access_key: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  63373362643230396364306438653862303664393361313861316265366661636438376430346637
  3866336430396264653464303035656561346161313935650a333661383438666437363133336362
  65316464363361323935626237393336363461353736303130653231663261343464356265623135
  6565366466353064610a356435303432366532616236616331623332633461353535343864386230
  30396232333537613339386131323238323066316533643137656331383036396631623063386665
  3261356137353061343863346638326539643938323762323763

# Useful paths
data_folder: "/home/{{ ansible_user }}"
app_folder: "{{ data_folder }}/app"

docker_compose:
  services:
    unifi:
      image: linuxserver/unifi-controller
      container_name: unifi
      network_mode: host
      volumes:
        - "{{ app_folder }}/unifi:/config"
      restart: "no"
      environment:
        - "PUID={{ uid }}"
        - "PGID={{ gid }}"
        - "TZ=America/Toronto"
    ddns: &ddns
      container_name: ddns
      image: sjmayotte/route53-dynamic-dns:latest
      networks:
        - apps
      environment: &ddns_environment
        AWS_ACCESS_KEY_ID: "{{ aws_access_key_id }}"
        AWS_SECRET_ACCESS_KEY: "{{ aws_secret_access_key }}"
        AWS_REGION: us-east-1
        ROUTE53_HOSTED_ZONE_ID: "{{ aws_ddns_hosted_zone }}"
        ROUTE53_TYPE: A
        ROUTE53_TTL: "300"
        UPDATE_FREQUENCY: "60000"
        SEND_EMAIL_SES: "true"
        SES_FROM_ADDRESS: "{{ ansible_email }}"
        SES_TO_ADDRESS: "{{ ansible_email }}"
        ROUTE53_DOMAIN: "{{ inventory_hostname }}"
    ddns-tower:
      <<: *ddns
      container_name: ddns-tower
      environment:
        <<: *ddns_environment
        ROUTE53_DOMAIN: tower.bovbel.com
    ddns-franklin:
      <<: *ddns
      container_name: ddns-franklin
      environment:
        <<: *ddns_environment
        ROUTE53_DOMAIN: franklin.bovbel.com
    ddns-octopi:
      <<: *ddns
      container_name: ddns-octopi
      environment:
        <<: *ddns_environment
        ROUTE53_DOMAIN: octopi.bovbel.com
    ddns-metal:
      <<: *ddns
      container_name: ddns-metal
      environment:
        <<: *ddns_environment
        ROUTE53_DOMAIN: metal.bovbel.com

caddy:
  remotes:
    franklin:
      host: franklin
      domain: bovbel.com
      auth: oauth
      scheme: https
      port: 443
      users: "{{ admin_users }}"

    metal:
      host: metal
      domain: bovbel.com
      auth: oauth
      scheme: https
      port: 443
      users: "{{ admin_users }}"

    octopi:
      host: octopi
      domain: bovbel.com
      auth: basic
      user: "{{ web_user }}"
      password: "{{ web_password }}"
      port: 80
